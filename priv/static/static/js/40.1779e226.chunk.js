webpackJsonp([40],{1719:function(e,t,a){"use strict";function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function c(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=a(0),o=a.n(i),s=a(8),m=a.n(s),u=a(58),d=a(767),p=(a.n(d),a(80)),f=a.n(p),h=a(908),g=(a.n(h),a(987)),v=(a.n(g),a(845)),E=a.n(v),b=a(253),C=(a.n(b),a(41)),_=a(27),N=a(1249),y=a(42),O=(a(262),a(829),a(828),a(261),a(730)),k=a(6),D=a(907),S=a(728),w=a(815),I=a(777),R=a(264),F=a.n(R),U=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),j=function(e){function t(){var e,a,c,i;r(this,t);for(var o=arguments.length,s=Array(o),m=0;m<o;m++)s[m]=arguments[m];return a=c=l(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),c.state={confirmDelete:!1,confirmUpdate:!1,center:{},centerBuffer:{},centerRaw:{},sketchFile:null,deployment:{startDate:new Date,endDate:new Date,printers:[],machines:[]}},c._handleDeleteCenter=function(){var e=c.state.centerBuffer.id,t=c.props;(0,t.deleteCenter)(t.authUser.token,e),c.setState({confirmDelete:!1})},c._handleUpdateCenter=function(){var e=c.state,t=e.center,a=t.name,n=t.code,r=t.ghana_post_gps,l=t.longitude,i=t.latitude,o=t.sketchFile,s=t.contact_name,m=t.contact_phone,u=t.preferred_network,d=t.backup_network,p=t.recomended,f=e.centerBuffer.id,h=(e.deployment,c.props),g=h.editCenter,v=h.authUser.token,E=new FormData;E.append("name",a),E.append("code",n),E.append("ghana_post_gps",r),E.append("longitude",l),E.append("latitude",i),E.append("sketch",o),E.append("contact_name",s),E.append("contact_phone",m),E.append("preferred_network",u),E.append("backup_network",d),E.append("recomended",p),g(v,f,E),c.setState({confirmUpdate:!1})},c._handleInputChange=function(e,t){var a=Object.assign({},c.state.center,n({},e,t));console.log(e,t,a),c.setState({center:a})},c._isFormValid=function(){var e=c.state.center,t=e.name,a=e.code,n=e.ghana_post_gps,r=e.longitude,l=e.latitude,i={name:t,code:a,ghana_post_gps:n,longitude:r,latitude:l};return Object(O.a)(i)},c._isDeploymentFormValid=function(){var e=c.state.deployment,t=e.startDate,a=e.endDate,n=e.printers,r=e.machines,l={startDate:F()(t,"X"),endDate:F()(a,"X")};return console.log(l),Object(O.a)(l)&&!E()(n)&&!E()(r)},c._handleCenterDeployment=function(){var e=c.state,t=e.deployment,a=t.startDate,n=t.endDate,r=t.machines,l=t.printers,i=e.center.id,o=c.props,s=o.authUser.token,m=o.editCenter,u=new FormData;u.append("start_date",F()(a,"X")),u.append("end_date",F()(n,"X"));for(var d=0;d<r.length;d++)u.append("machines[]",r[d].id);for(var p=0;p<l.length;p++)u.append("printers[]",l[p].id);u.append("deployment","1"),u.append("center_id",i),u.append("status","1"),m(s,i,u)},c._handlePrintersOnChange=function(e){c.setState({deployment:Object.assign({},c.state.deployment,{printers:e})})},c._handleMachinesOnChange=function(e){c.setState({deployment:Object.assign({},c.state.deployment,{machines:e})})},i=a,l(c,i)}return c(t,e),U(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.centerId,a=e.authUser.token,n=e.loadCenter;console.log("selected ",t),t&&n(a,t)}},{key:"componentDidUpdate",value:function(e){var t=e.centerId,a=this.props,n=a.authUser.token,r=a.loadCenter,l=a.centerId,c=this.state.center;f()(t,l)||r(n,l);var i=e.OPERATION_SUCCESSFUL,o=e.OPERATION_FAILED,s=this.props,m=s.OPERATION_SUCCESSFUL,d=s.OPERATION_FAILED;if(!f()(i,m)){var p=m.action;p===k._13&&(r(n,l),S.a.show({message:c.name+" Successfully Updated \ud83d\ude03",intent:u.x.SUCCESS,icon:"tick"})),p===k.O&&S.a.show({message:c.name+" Successfully Removed \ud83d\ude03",intent:u.x.SUCCESS,icon:"tick"})}if(!f()(d,o)){var h=d.action;h===k._13&&S.a.show({message:"Could Not Update "+c.name+" \ud83d\ude1e",intent:u.x.DANGER,icon:"error"}),h===k.O&&S.a.show({message:"Could Not Remove "+c.name+" \ud83d\ude1e",intent:u.x.DANGER,icon:"error"})}}},{key:"render",value:function(){var e=this,t=this.state,a=t.confirmDelete,n=t.confirmUpdate,r=t.center,l=t.centerBuffer,c=t.deployment,i=this.props,s=i.loadingCenter,m=i.machines,d=i.printers,p=i.editingCenter,h=!this._isFormValid()||f()(r,l),g=!this._isDeploymentFormValid(),v=d.map(function(e){return{id:e.id,name:e.serial}}),E=m.map(function(e){return{id:e.id,name:e.name}});return o.a.createElement(u.g,{className:"Details"},o.a.createElement("header",{className:"Header"},o.a.createElement("div",{style:{display:"flex",alignItems:"center"}},s?o.a.createElement(u.N,{className:"bp3-small"}):o.a.createElement(u.v,{icon:"map-marker"}),o.a.createElement(u.v,{icon:"blank"}),o.a.createElement(u.S,{className:"devices__text"},"Center ",o.a.createElement("small",{className:"bp3-text-muted"},r.id&&"| "+r.name))),this.props.center.id&&o.a.createElement(u.f,null,o.a.createElement(u.H,{disabled:h,isOpen:n,interactionKind:u.I.CLICK,position:u.J.BOTTOM},o.a.createElement(u.e,{disabled:h,loading:p,onClick:function(){return e.setState({confirmUpdate:!0})},icon:"floppy-disk",intent:u.x.WARNING}),o.a.createElement("div",{style:{padding:".5rem",display:"flex",flexDirection:"column"}},o.a.createElement("header",null,"Are you sure?"),o.a.createElement("div",{style:{display:"flex",justifyContent:"space-evenly",marginTop:".5rem"}},o.a.createElement(u.e,{onClick:function(){return e._handleUpdateCenter()},small:!0,text:"yes",intent:u.x.SUCCESS}),o.a.createElement(u.e,{onClick:function(){return e.setState({confirmUpdate:!1})},small:!0,text:"no",intent:u.x.DANGER})))),o.a.createElement(u.H,{isOpen:a,interactionKind:u.I.CLICK,position:u.J.BOTTOM},o.a.createElement(u.e,{onClick:function(){return e.setState({confirmDelete:!0})},icon:"trash",intent:u.x.DANGER}),o.a.createElement("div",{style:{padding:".5rem",display:"flex",flexDirection:"column"}},o.a.createElement("header",null,"Are you sure?"),o.a.createElement("div",{style:{display:"flex",justifyContent:"space-evenly",marginTop:".5rem"}},o.a.createElement(u.e,{onClick:function(){return e._handleDeleteCenter()},small:!0,text:"yes",intent:u.x.SUCCESS}),o.a.createElement(u.e,{onClick:function(){return e.setState({confirmDelete:!1})},small:!0,text:"no",intent:u.x.DANGER})))))),r.id?o.a.createElement("div",{className:"Content"},o.a.createElement("section",{className:"Basics"},o.a.createElement("header",{className:"Header"},"Basic Information"),o.a.createElement("section",{className:"Content__Simple"},o.a.createElement("div",{className:"mm-input-group"},o.a.createElement("label",{className:"mm-label",htmlFor:"name"}," Name "),o.a.createElement(u.w,{className:"mm-input",onChange:function(t){var a=t.target,n=a.name,r=a.value;return e._handleInputChange(n,r)},name:"name",value:r.name||"",id:"name"})),o.a.createElement("div",{className:"mm-input-group"},o.a.createElement("label",{className:"mm-label",htmlFor:"code"}," Code "),o.a.createElement(u.w,{className:"mm-input",onChange:function(t){var a=t.target,n=a.name,r=a.value;return e._handleInputChange(n,r)},name:"code",value:r.code||"",id:"code"})))),o.a.createElement("section",{className:"Location"},o.a.createElement("header",{className:"Header"},"Location"),o.a.createElement("section",{className:"Content__Simple"},o.a.createElement("div",{className:"Column"},o.a.createElement("div",{className:"mm-input-group"},o.a.createElement("label",{className:"mm-label",htmlFor:"region"}," Region "),o.a.createElement(u.w,{className:"mm-input",id:"region",onChange:function(t){var a=t.target,n=a.name,r=a.value;return e._handleInputChange(n,r)},name:"region_id",value:r.region_id||""})),o.a.createElement("div",{className:"mm-input-group"},o.a.createElement("label",{className:"mm-label",htmlFor:"district"}," District "),o.a.createElement(u.w,{className:"mm-input",id:"district",onChange:function(t){var a=t.target,n=a.name,r=a.value;return e._handleInputChange(n,r)},name:"district_id",value:r.district_id||""})),o.a.createElement("div",{className:"mm-input-group"},o.a.createElement("label",{className:"mm-label",htmlFor:"gpgps"}," Ghana Post GPS "),o.a.createElement(u.w,{className:"mm-input",id:"gpgps",onChange:function(t){var a=t.target,n=a.name,r=a.value;return e._handleInputChange(n,r)},name:"ghana_post_gps",value:r.ghana_post_gps||""})),o.a.createElement("div",{className:"mm-input-group"},o.a.createElement("label",{className:"mm-label",htmlFor:"long"}," Longitude "),o.a.createElement(u.w,{className:"mm-input",id:"long",onChange:function(t){var a=t.target,n=a.name,r=a.value;return e._handleInputChange(n,r)},name:"longitude",value:r.longitude||""})),o.a.createElement("div",{className:"mm-input-group"},o.a.createElement("label",{className:"mm-label",htmlFor:"lat"}," Latitude "),o.a.createElement(u.w,{className:"mm-input",id:"lat",onChange:function(t){var a=t.target,n=a.name,r=a.value;return e._handleInputChange(n,r)},name:"latitude",value:r.latitude||""})),o.a.createElement("div",{className:"mm-input-group"},o.a.createElement("label",{className:"mm-label",htmlFor:"sketch"}," Arrangement Sketch "),o.a.createElement(u.p,{id:"sketch",className:"mm-input",text:"Choose file...",onChange:function(t){var a=t.target.files,n=URL.createObjectURL(a[0]);e._handleInputChange("sketch",n)}}))),o.a.createElement("div",{className:"Column"},o.a.createElement(u.g,{elevation:u.o.ONE,className:"Location__Sketch__Preview"},o.a.createElement("img",{style:{objectFit:"contain",with:"calc(100% - .4rem)",height:"calc(100% - .4rem)"},src:this.state.sketch||r.sketch}))))),o.a.createElement("section",{className:"Contact"},o.a.createElement("header",{className:"Header"},"Contact Person"),o.a.createElement("section",{className:"Content__Simple"},o.a.createElement("div",{className:"mm-input-group"},o.a.createElement("label",{className:"mm-label",htmlFor:"contact-name"}," Full name "),o.a.createElement(u.w,{className:"mm-input",id:"contact-name",onChange:function(t){var a=t.target,n=a.name,r=a.value;return e._handleInputChange(n,r)},name:"contact_name",value:r.contact_name||""})),o.a.createElement("div",{className:"mm-input-group"},o.a.createElement("label",{className:"mm-label",htmlFor:"contact-number"}," Phone number "),o.a.createElement(u.w,{className:"mm-input",id:"contact-number",onChange:function(t){var a=t.target,n=a.name,r=a.value;return e._handleInputChange(n,r)},name:"contact_phone",value:r.contact_phone||""})))),o.a.createElement("section",{className:"Recommendations"},o.a.createElement("header",{className:"Header"},"Site survey recommendation"),o.a.createElement("section",{className:"Content__Simple"},o.a.createElement("div",{className:"Column"},o.a.createElement("div",{className:"mm-input-group"},o.a.createElement("label",{className:"mm-label",htmlFor:"preferred-network"}," Preferred Network "),o.a.createElement(u.w,{className:"mm-input",id:"preferred-network",onChange:function(t){var a=t.target,n=a.name,r=a.value;return e._handleInputChange(n,r)},name:"preferred_network",value:r.preferred_network||""}))),o.a.createElement("div",{className:"Column"},o.a.createElement("div",{className:"mm-input-group"},o.a.createElement("label",{className:"mm-label",htmlFor:"backup-network"}," Backup Network "),o.a.createElement(u.w,{className:"mm-input",id:"backup-network",onChange:function(t){var a=t.target,n=a.name,r=a.value;return e._handleInputChange(n,r)},name:"backup_network",value:r.backup_network||""})),o.a.createElement(u.q,{inline:!0,label:"Recommended for registration",labelFor:"recommended"},o.a.createElement(u.M,{inline:!0,onChange:function(t){var a=t.currentTarget.value;return e._handleInputChange("recomended",a)},selectedValue:r.recomended},o.a.createElement(u.L,{label:"Yes",value:"1"}),o.a.createElement(u.L,{label:"No",value:"0"})))))),o.a.createElement(u.g,{elevation:u.o.TWO,className:"Deployment"},o.a.createElement("header",{className:"Header"},o.a.createElement("span",null,"Deployment Information"),o.a.createElement(u.f,null,o.a.createElement(u.H,{position:u.J.BOTTOM_RIGHT,interactionKind:u.I.CLICK_TARGET_ONLY},o.a.createElement("button",{className:"bp3-button bp3-intent-primary bp3-icon-plus"}),o.a.createElement("div",{style:{padding:".5rem"},className:"deployment__pop"},o.a.createElement("label",{className:"bp3-label"},"Start Date",o.a.createElement(w.a,{onChange:function(t){return e.setState({deployment:Object.assign({},e.state.deployment,{startDate:t})})},value:this.state.deployment.startDate,parseDate:function(e){return new Date(e)},formatDate:function(e){return e.toDateString()}})),o.a.createElement("label",{className:"bp3-label"},"End Date",o.a.createElement(w.a,{onChange:function(t){return e.setState({deployment:Object.assign({},e.state.deployment,{endDate:t})})},value:this.state.deployment.endDate,parseDate:function(e){return new Date(e)},formatDate:function(e){return e.toDateString()}})),o.a.createElement("label",{className:"bp3-label"},"Printers",o.a.createElement(I.c,{defaultValues:c.printers,onChange:this._handlePrintersOnChange,items:v})),o.a.createElement("label",{className:"bp3-label"},"MRWs",o.a.createElement(I.c,{defaultValues:c.machines,onChange:this._handleMachinesOnChange,items:E})),o.a.createElement(u.e,{disabled:g,loading:p,onClick:function(){return e._handleCenterDeployment()},intent:u.x.PRIMARY,icon:"tick",text:"save"}))))),o.a.createElement("div",{className:"Table__Content"},o.a.createElement(N.b,{data:r.deployments})))):o.a.createElement("div",{className:"bp3-non-ideal-state"},o.a.createElement("div",{className:"bp3-non-ideal-state-visual"},o.a.createElement("span",{className:"bp3-icon bp3-icon-map-marker"})),o.a.createElement("h4",{className:"bp3-heading"},"No Center Selected"),o.a.createElement("div",null,"Select any center to view details")))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a=e.center,n=t.center;if(console.log("get",n,a),f()(a,n))return null;var r=f()(a.id,n.id)?Object.assign({},a,n):Object.assign({},a);return{center:Object.assign({},r),centerBuffer:Object.assign({},a),centerRaw:Object.assign({},a)}}}]),t}(o.a.Component);j.propTypes={authUser:m.a.object.isRequired,OPERATION_SUCCESSFUL:m.a.object.isRequired,OPERATION_FAILED:m.a.object.isRequired,centerId:m.a.string.isRequired,center:m.a.object.isRequired,loadingCenter:m.a.bool.isRequired,editingCenter:m.a.bool.isRequired,deletingCenter:m.a.bool.isRequired,loadCenter:m.a.func.isRequired,editCenter:m.a.func.isRequired,deleteCenter:m.a.func.isRequired,machines:m.a.array.isRequired,printers:m.a.array.isRequired};var x=function(e){return{authUser:e.authUser,OPERATION_SUCCESSFUL:e.OPERATION_SUCCESSFUL,OPERATION_FAILED:e.OPERATION_FAILED,match:e.match,history:e.history,location:e.location,center:e.center,loadingCenter:e.loadingCenter,editingCenter:e.editingCenter,deletingCenter:e.deletingCenter,printers:e.printers,machines:e.machines}},A=function(e){return Object(y.b)({loadCenter:D.d,editCenter:D.c,deleteCenter:D.b},e)};t.default=Object(C.f)(Object(_.b)(x,A)(j))},728:function(e,t,a){"use strict";var n=a(58);t.a=n.T.create({position:n.J.TOP})},730:function(e,t,a){"use strict";function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return Array.from(e)}function l(e){var t=[];return i()(e,function(e,a){if("number"===typeof e)if(e){var l;t=[].concat(r(t),[(l={},n(l,a,e),n(l,"valid",!0),l)])}else{var c;t=[].concat(r(t),[(c={},n(c,a,e),n(c,"valid",!1),c)])}else if("string"===typeof e)if(e.trim().length>0){var i;t=[].concat(r(t),[(i={},n(i,a,e),n(i,"valid",!0),i)])}else{var o;t=[].concat(r(t),[(o={},n(o,a,e),n(o,"valid",!1),o)])}else if(s()(e))if(e.length>0){var m;t=[].concat(r(t),[(m={},n(m,a,e),n(m,"valid",!0),m)])}else{var u;t=[].concat(r(t),[(u={},n(u,a,e),n(u,"valid",!1),u)])}else{var d;t=[].concat(r(t),[(d={},n(d,a,e),n(d,"valid",!1),d)])}}),console.log("form validation",t),u()(t,"valid")}t.a=l;var c=a(732),i=a.n(c),o=a(14),s=a.n(o),m=a(734),u=a.n(m)},732:function(e,t,a){function n(e,t){return e&&r(e,l(t))}var r=a(256),l=a(733);e.exports=n},733:function(e,t,a){function n(e){return"function"==typeof e?e:r}var r=a(60);e.exports=n},734:function(e,t,a){function n(e,t,a){var n=i(e)?r:l;return a&&o(e,t,a)&&(t=void 0),n(e,c(t,3))}var r=a(735),l=a(736),c=a(59),i=a(14),o=a(257);e.exports=n},735:function(e,t){function a(e,t){for(var a=-1,n=null==e?0:e.length;++a<n;)if(!t(e[a],a,e))return!1;return!0}e.exports=a},736:function(e,t,a){function n(e,t){var a=!0;return r(e,function(e,n,r){return a=!!t(e,n,r)}),a}var r=a(136);e.exports=n}});
//# sourceMappingURL=40.1779e226.chunk.js.map